[{"name":"sql.active_record","payload":{"sql":"SELECT  \"products\".* FROM \"products\" WHERE \"products\".\"id\" = $1 LIMIT $2","name":"Product Load","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"id","value_before_type_cast":"240","type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":"240","value_for_database":240},{"name":"LIMIT","value_before_type_cast":1,"type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":1}],"line":7,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"initialize"},"time":"2017-04-17T13:22:05.303+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.306+03:00","children":[],"duration":2.886394},{"name":"sql.active_record","payload":{"sql":"BEGIN","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":25,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"update_product"},"time":"2017-04-17T13:22:05.308+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.309+03:00","children":[],"duration":0.686208},{"name":"sql.active_record","payload":{"sql":"SELECT  1 AS one FROM \"products\" WHERE \"products\".\"slug\" = $1 AND (\"products\".\"id\" != $2) LIMIT $3","name":"Product Exists","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"slug","value_before_type_cast":"product2","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"product2","value_for_database":"product2"},{"name":"id","value_before_type_cast":240,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":240,"value_for_database":240},{"name":"LIMIT","value_before_type_cast":1,"type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":1}],"line":25,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"update_product"},"time":"2017-04-17T13:22:05.312+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.314+03:00","children":[],"duration":1.6705809999999999},{"name":"sql.active_record","payload":{"sql":"UPDATE \"products\" SET \"qty\" = $1, \"updated_at\" = $2 WHERE \"products\".\"id\" = $3","name":"SQL","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"qty","value_before_type_cast":18,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":18,"value_for_database":18},{"name":"updated_at","value_before_type_cast":"2017-04-17T10:22:05.316Z","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"2017-04-17T10:22:05.316Z","value_for_database":"2017-04-17T10:22:05.316Z"},{"name":"id","value_before_type_cast":240,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":240,"value_for_database":240}],"line":25,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"update_product"},"time":"2017-04-17T13:22:05.318+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.319+03:00","children":[],"duration":1.171539},{"name":"sql.active_record","payload":{"sql":"COMMIT","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":25,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"update_product"},"time":"2017-04-17T13:22:05.321+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.360+03:00","children":[],"duration":38.42237},{"name":"sql.active_record","payload":{"sql":"              SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n                     pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod,\n             (SELECT c.collname FROM pg_collation c, pg_type t\n               WHERE c.oid = a.attcollation AND t.oid = a.atttypid AND a.attcollation \u003c\u003e t.typcollation),\n                     col_description(a.attrelid, a.attnum) AS comment\n                FROM pg_attribute a LEFT JOIN pg_attrdef d\n                  ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n               WHERE a.attrelid = '\"orders\"'::regclass\n                 AND a.attnum \u003e 0 AND NOT a.attisdropped\n               ORDER BY a.attnum\n","name":"SCHEMA","connection_id":69980553017640,"statement_name":null,"binds":[],"line":29,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.367+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.369+03:00","children":[],"duration":2.1815089999999997},{"name":"sql.active_record","payload":{"sql":"            SELECT c.relname\n            FROM pg_class c\n            LEFT JOIN pg_namespace n ON n.oid = c.relnamespace\n            WHERE c.relkind IN ('r', 'v','m') -- (r)elation/table, (v)iew, (m)aterialized view\n            AND n.nspname = ANY (current_schemas(false))\n","name":"SCHEMA","connection_id":69980553017640,"statement_name":null,"binds":[],"line":29,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.372+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.373+03:00","children":[],"duration":1.272972},{"name":"sql.active_record","payload":{"sql":"WITH pk_constraint AS (\n  SELECT conrelid, unnest(conkey) AS connum FROM pg_constraint\n  WHERE contype = 'p'\n    AND conrelid = '\"orders\"'::regclass\n), cons AS (\n  SELECT conrelid, connum, row_number() OVER() AS rownum FROM pk_constraint\n)\nSELECT attr.attname FROM pg_attribute attr\nINNER JOIN cons ON attr.attrelid = cons.conrelid AND attr.attnum = cons.connum\nORDER BY cons.rownum\n","name":"SCHEMA","connection_id":69980553017640,"statement_name":null,"binds":[],"line":29,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.374+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.377+03:00","children":[],"duration":2.410826},{"name":"sql.active_record","payload":{"sql":"BEGIN","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":29,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.392+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.393+03:00","children":[],"duration":0.888906},{"name":"sql.active_record","payload":{"sql":"INSERT INTO \"orders\" (\"created_at\", \"updated_at\", \"customer_phone\", \"total_price\", \"size_type\") VALUES ($1, $2, $3, $4, $5) RETURNING \"id\"","name":"SQL","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"created_at","value_before_type_cast":"2017-04-17T10:22:05.394Z","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"2017-04-17T10:22:05.394Z","value_for_database":"2017-04-17T10:22:05.394Z"},{"name":"updated_at","value_before_type_cast":"2017-04-17T10:22:05.394Z","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"2017-04-17T10:22:05.394Z","value_for_database":"2017-04-17T10:22:05.394Z"},{"name":"customer_phone","value_before_type_cast":"123123","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"123123","value_for_database":"123123"},{"name":"total_price","value_before_type_cast":200,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":200,"value_for_database":200},{"name":"size_type","value_before_type_cast":"quick_order","type":{"name":"size_type","mapping":{"normal_order":0,"quick_order":1},"subtype":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"}},"original_attribute":null,"value":"quick_order","value_for_database":1}],"line":29,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.395+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.397+03:00","children":[],"duration":1.24989},{"name":"sql.active_record","payload":{"sql":"COMMIT","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":29,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.399+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.432+03:00","children":[],"duration":33.510745},{"name":"sql.active_record","payload":{"sql":"              SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n                     pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod,\n             (SELECT c.collname FROM pg_collation c, pg_type t\n               WHERE c.oid = a.attcollation AND t.oid = a.atttypid AND a.attcollation \u003c\u003e t.typcollation),\n                     col_description(a.attrelid, a.attnum) AS comment\n                FROM pg_attribute a LEFT JOIN pg_attrdef d\n                  ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n               WHERE a.attrelid = '\"line_items\"'::regclass\n                 AND a.attnum \u003e 0 AND NOT a.attisdropped\n               ORDER BY a.attnum\n","name":"SCHEMA","connection_id":69980553017640,"statement_name":null,"binds":[],"line":30,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.440+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.444+03:00","children":[],"duration":3.7653309999999998},{"name":"sql.active_record","payload":{"sql":"WITH pk_constraint AS (\n  SELECT conrelid, unnest(conkey) AS connum FROM pg_constraint\n  WHERE contype = 'p'\n    AND conrelid = '\"line_items\"'::regclass\n), cons AS (\n  SELECT conrelid, connum, row_number() OVER() AS rownum FROM pk_constraint\n)\nSELECT attr.attname FROM pg_attribute attr\nINNER JOIN cons ON attr.attrelid = cons.conrelid AND attr.attnum = cons.connum\nORDER BY cons.rownum\n","name":"SCHEMA","connection_id":69980553017640,"statement_name":null,"binds":[],"line":30,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.446+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.449+03:00","children":[],"duration":3.317804},{"name":"sql.active_record","payload":{"sql":"BEGIN","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":30,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.460+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.461+03:00","children":[],"duration":0.7846599999999999},{"name":"sql.active_record","payload":{"sql":"INSERT INTO \"line_items\" (\"product_id\", \"order_id\", \"product_name\", \"product_price\", \"total_price\") VALUES ($1, $2, $3, $4, $5) RETURNING \"id\"","name":"SQL","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"product_id","value_before_type_cast":240,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":240,"value_for_database":240},{"name":"order_id","value_before_type_cast":86,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":86,"value_for_database":86},{"name":"product_name","value_before_type_cast":"Товар","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"Товар","value_for_database":"Товар"},{"name":"product_price","value_before_type_cast":"200.0","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"200.0","value_for_database":"200.0"},{"name":"total_price","value_before_type_cast":200,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":200,"value_for_database":200}],"line":30,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.463+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.464+03:00","children":[],"duration":1.139754},{"name":"sql.active_record","payload":{"sql":"COMMIT","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":30,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_order/create_quick.rb","method":"create_order"},"time":"2017-04-17T13:22:05.466+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:22:05.477+03:00","children":[],"duration":11.05353},{"name":"process_action.action_controller","payload":{"controller":"Site::OrdersController","action":"create_quick","params":{"utf8":"✓","authenticity_token":"jNSSNv9TSvlDT9+ttxe/ks2wJHc1undKtNss0hm3S9sik2OL4ioy+LKwhskLL2+rIxc/grHSmltNQNpYbvtp4A==","customer_phone":"123123","product_id":"240","commit":"Купить в один клик","controller":"site/orders","action":"create_quick"},"headers":"Not JSON Encodable","format":"js","method":"POST","path":"/orders/create_quick","status":200,"view_runtime":0.18175099921791116,"db_runtime":98.86919100000001},"time":"2017-04-17T13:22:05.299+03:00","transaction_id":"c2ba504179ab8d0ca439","end":"2017-04-17T13:22:05.478+03:00","children":[],"duration":179.589562}]