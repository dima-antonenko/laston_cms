[{"name":"sql.active_record","payload":{"sql":"WITH pk_constraint AS (\n  SELECT conrelid, unnest(conkey) AS connum FROM pg_constraint\n  WHERE contype = 'p'\n    AND conrelid = '\"carts\"'::regclass\n), cons AS (\n  SELECT conrelid, connum, row_number() OVER() AS rownum FROM pk_constraint\n)\nSELECT attr.attname FROM pg_attribute attr\nINNER JOIN cons ON attr.attrelid = cons.conrelid AND attr.attnum = cons.connum\nORDER BY cons.rownum\n","name":"SCHEMA","connection_id":69980553017640,"statement_name":null,"binds":[],"line":5,"filename":"/home/dima/Rails/laston_cms/app/helpers/current_cart.rb","method":"set_cart"},"time":"2017-04-17T13:34:34.244+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.248+03:00","children":[],"duration":3.371703},{"name":"sql.active_record","payload":{"sql":"              SELECT a.attname, format_type(a.atttypid, a.atttypmod),\n                     pg_get_expr(d.adbin, d.adrelid), a.attnotnull, a.atttypid, a.atttypmod,\n             (SELECT c.collname FROM pg_collation c, pg_type t\n               WHERE c.oid = a.attcollation AND t.oid = a.atttypid AND a.attcollation \u003c\u003e t.typcollation),\n                     col_description(a.attrelid, a.attnum) AS comment\n                FROM pg_attribute a LEFT JOIN pg_attrdef d\n                  ON a.attrelid = d.adrelid AND a.attnum = d.adnum\n               WHERE a.attrelid = '\"carts\"'::regclass\n                 AND a.attnum \u003e 0 AND NOT a.attisdropped\n               ORDER BY a.attnum\n","name":"SCHEMA","connection_id":69980553017640,"statement_name":null,"binds":[],"line":5,"filename":"/home/dima/Rails/laston_cms/app/helpers/current_cart.rb","method":"set_cart"},"time":"2017-04-17T13:34:34.249+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.251+03:00","children":[],"duration":2.4941009999999997},{"name":"sql.active_record","payload":{"sql":"SELECT  \"carts\".* FROM \"carts\" WHERE \"carts\".\"id\" = $1 LIMIT $2","name":"Cart Load","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"id","value_before_type_cast":null,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":null,"value_for_database":null},{"name":"LIMIT","value_before_type_cast":1,"type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":1}],"line":5,"filename":"/home/dima/Rails/laston_cms/app/helpers/current_cart.rb","method":"set_cart"},"time":"2017-04-17T13:34:34.255+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.258+03:00","children":[],"duration":3.08044},{"name":"sql.active_record","payload":{"sql":"BEGIN","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":7,"filename":"/home/dima/Rails/laston_cms/app/helpers/current_cart.rb","method":"rescue in set_cart"},"time":"2017-04-17T13:34:34.265+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.266+03:00","children":[],"duration":0.805432},{"name":"sql.active_record","payload":{"sql":"INSERT INTO \"carts\" (\"created_at\", \"updated_at\") VALUES ($1, $2) RETURNING \"id\"","name":"SQL","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"created_at","value_before_type_cast":"2017-04-17T10:34:34.267Z","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"2017-04-17T10:34:34.267Z","value_for_database":"2017-04-17T10:34:34.267Z"},{"name":"updated_at","value_before_type_cast":"2017-04-17T10:34:34.267Z","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"2017-04-17T10:34:34.267Z","value_for_database":"2017-04-17T10:34:34.267Z"}],"line":7,"filename":"/home/dima/Rails/laston_cms/app/helpers/current_cart.rb","method":"rescue in set_cart"},"time":"2017-04-17T13:34:34.268+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.269+03:00","children":[],"duration":1.199718},{"name":"sql.active_record","payload":{"sql":"COMMIT","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":7,"filename":"/home/dima/Rails/laston_cms/app/helpers/current_cart.rb","method":"rescue in set_cart"},"time":"2017-04-17T13:34:34.271+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.318+03:00","children":[],"duration":47.912352999999996},{"name":"sql.active_record","payload":{"sql":"SELECT  \"products\".* FROM \"products\" WHERE \"products\".\"slug\" = $1 ORDER BY \"products\".\"id\" ASC LIMIT $2","name":"Product Load","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"slug","value_before_type_cast":"product2","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"product2","value_for_database":"product2"},{"name":"LIMIT","value_before_type_cast":1,"type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":1}],"line":6,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"initialize"},"time":"2017-04-17T13:34:34.321+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.323+03:00","children":[],"duration":1.322889},{"name":"sql.active_record","payload":{"sql":"SELECT  \"line_items\".* FROM \"line_items\" WHERE \"line_items\".\"cart_id\" = $1 AND \"line_items\".\"product_id\" = $2 LIMIT $3","name":"LineItem Load","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"cart_id","value_before_type_cast":21,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":21,"value_for_database":21},{"name":"product_id","value_before_type_cast":240,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":240,"value_for_database":240},{"name":"LIMIT","value_before_type_cast":1,"type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":1}],"line":13,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"main"},"time":"2017-04-17T13:34:34.335+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.336+03:00","children":[],"duration":1.335698},{"name":"sql.active_record","payload":{"sql":"BEGIN","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":37,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"add_new_line_item"},"time":"2017-04-17T13:34:34.349+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.349+03:00","children":[],"duration":0.7356189999999999},{"name":"sql.active_record","payload":{"sql":"INSERT INTO \"line_items\" (\"product_id\", \"cart_id\", \"product_name\", \"product_price\", \"total_price\") VALUES ($1, $2, $3, $4, $5) RETURNING \"id\"","name":"SQL","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"product_id","value_before_type_cast":240,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":240,"value_for_database":240},{"name":"cart_id","value_before_type_cast":21,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":21,"value_for_database":21},{"name":"product_name","value_before_type_cast":"Товар","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"Товар","value_for_database":"Товар"},{"name":"product_price","value_before_type_cast":"200.0","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"200.0","value_for_database":"200.0"},{"name":"total_price","value_before_type_cast":200,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":200,"value_for_database":200}],"line":37,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"add_new_line_item"},"time":"2017-04-17T13:34:34.351+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.352+03:00","children":[],"duration":1.132466},{"name":"sql.active_record","payload":{"sql":"COMMIT","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":37,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"add_new_line_item"},"time":"2017-04-17T13:34:34.354+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.363+03:00","children":[],"duration":9.222662},{"name":"sql.active_record","payload":{"sql":"BEGIN","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":33,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"update_product"},"time":"2017-04-17T13:34:34.364+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.365+03:00","children":[],"duration":0.62358},{"name":"sql.active_record","payload":{"sql":"SELECT  1 AS one FROM \"products\" WHERE \"products\".\"slug\" = $1 AND (\"products\".\"id\" != $2) LIMIT $3","name":"Product Exists","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"slug","value_before_type_cast":"product2","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"product2","value_for_database":"product2"},{"name":"id","value_before_type_cast":240,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":240,"value_for_database":240},{"name":"LIMIT","value_before_type_cast":1,"type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":1}],"line":33,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"update_product"},"time":"2017-04-17T13:34:34.368+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.369+03:00","children":[],"duration":1.028649},{"name":"sql.active_record","payload":{"sql":"UPDATE \"products\" SET \"qty\" = $1, \"updated_at\" = $2 WHERE \"products\".\"id\" = $3","name":"SQL","connection_id":69980553017640,"statement_name":null,"binds":[{"name":"qty","value_before_type_cast":16,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":16,"value_for_database":16},{"name":"updated_at","value_before_type_cast":"2017-04-17T10:34:34.371Z","type":{"precision":null,"scale":null,"limit":null},"original_attribute":null,"value":"2017-04-17T10:34:34.371Z","value_for_database":"2017-04-17T10:34:34.371Z"},{"name":"id","value_before_type_cast":240,"type":{"precision":null,"scale":null,"limit":null,"range":"-2147483648...2147483648"},"original_attribute":null,"value":240,"value_for_database":240}],"line":33,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"update_product"},"time":"2017-04-17T13:34:34.373+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.374+03:00","children":[],"duration":1.288648},{"name":"sql.active_record","payload":{"sql":"COMMIT","name":null,"connection_id":69980553017640,"statement_name":null,"binds":[],"line":33,"filename":"/home/dima/Rails/laston_cms/app/services/site/s_cart/add_product.rb","method":"update_product"},"time":"2017-04-17T13:34:34.377+03:00","transaction_id":"ddb3aaa36aefd92c5097","end":"2017-04-17T13:34:34.385+03:00","children":[],"duration":8.433928},{"name":"process_action.action_controller","payload":{"controller":"Site::LineItemsController","action":"create","params":{"authenticity_token":"u/9kYwXLC8hkQP8cze7OQCvqt6RU89Df3On3/YP4R5v1BNYgYNLufbQ0P/rqzD8ifptEYXW+pw+X3kFperO2Zw==","product_id":"product2","controller":"site/line_items","action":"create"},"headers":"Not JSON Encodable","format":"html","method":"POST","path":"/line_items?product_id=product2","status":302,"view_runtime":null,"db_runtime":75.394671},"time":"2017-04-17T13:34:34.238+03:00","transaction_id":"53307bbcd8969c35f637","end":"2017-04-17T13:34:34.387+03:00","children":[],"duration":149.670199}]